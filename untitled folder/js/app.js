(function(){$.fn.fitText=function(e,i){var t=e||1,n=$.extend({minFontSize:Number.NEGATIVE_INFINITY,maxFontSize:Number.POSITIVE_INFINITY},i);return this.each(function(){var e=$(this);var i=function(){e.css("font-size",Math.max(Math.min(e.width()/(t*10),parseFloat(n.maxFontSize)),parseFloat(n.minFontSize)))};i();$(window).on("resize.fittext orientationchange.fittext",i)})};Modernizr.addTest("inpagevideo",function(){return navigator.userAgent.match(/(iPhone|iPod)/g)?"playsInline"in document.createElement("video"):true});function e(e,i){var t;e=Number(e);return function(){if(--e>0){t=i.apply(this,arguments)}if(e<=1){i=undefined}return t}}function i(i){return e(2,i)}function t(e,i){i=typeof i==="number"?i:0;var t=e.getBoundingClientRect();return t.top<=window.innerHeight+i&&t.bottom>=0+i}var n=$(window).scrollTop(),o=n,a=100,r=25;function s(){var e=$(".Header .Header-menuItem"),i=e[0].getBoundingClientRect();if($(window).scrollTop()>o+r){$(".Header").removeClass("is-visible")}if($(window).scrollTop()<o-r){$(".Header").addClass("is-visible")}if($(window).scrollTop()<a){$(".Header").addClass("is-visible")}if($(".Header").hasClass("is-visible")){if($(window).scrollTop()<n&&o>n){o=n}}else{if($(window).scrollTop()>n&&o<n){o=n}}n=$(window).scrollTop();$(".Section-headingWrapper").each(function(e,i){$(i).toggleClass("is-inViewport",t(i))});var s=$(".Section--first"),l=t(s[0]),c=$(".Section--last"),d=c[0].getBoundingClientRect(),u=d.top<=0;if(!l){$("body").removeClass("is-showingIntro")}$(".Section--fixed").each(function(e,i){var t=$(window).scrollTop()/window.innerHeight,n=20*t,o=l?"translateY(-"+n+"em)":"",a=l?1-t*1.6:"";$(i).css("transform",o);$(i).find(".Section-headingWrapper--fixed").css("opacity",a)});$(".Section-scrollPrompt").toggleClass("is-hidden",!l);$(".Section--fixed").toggleClass("is-belowFirstSection",l).toggleClass("is-stickyPositioned",u);$(".Gallery-imgWrapper").each(function(e,i){var n=$(i).find(".Gallery-img");n.toggleClass("is-inViewport",t(n[0]))});$(".Section--first").each(function(){var e=$(this),i=$(".Section--fixed .Section-backgroundVideo"),t=i[0];var n=this.getBoundingClientRect(),o=Math.min(window.innerHeight,n.bottom),a=Math.max(0,n.top);if(o-a>e.height()*.8&&!t.ended){var r=t.play();if(r){r.catch(function(e){t.play()})}}});$(".Section--withSubsection").map(function(e,i){var t=i.getBoundingClientRect(),n=Math.min(window.innerHeight,t.bottom),o=Math.max(0,t.top);return{element:i,visiblePortion:n-o}}).sort(function(e,i){e=e.visiblePortion;i=i.visiblePortion;return e>i?-1:e===i?0:1}).each(function(e,i){var t=$(i.element).find(".Section-backgroundVideo"),n=t[0];if(!t.length){return}$(i.element).toggleClass("is-inViewport",e===0);if(e===0&&!n.ended&&Modernizr.autoplayvideo){n.play()}else{n.pause();if(i.visiblePortion<=0){try{n.currentTime=0}catch(o){}}}})}window.addEventListener("scroll",s,{passive:true});s();$(window).on("resize",function(){var e=window.innerWidth>=1400?1080:720;$(".Section-backgroundVideo").each(function(i){var t=$(this).attr("src"),n=t.replace(/(720|1080)p/,e+"p");if(t!==n){$(this).attr("src",n)}})}).trigger("resize");$(".Section-scrollPrompt, .Header-menuItem").on("click",function(e){var i=$($(this).attr("href")),t=i[0].getBoundingClientRect();$("html, body").animate({scrollTop:$(window).scrollTop()+t.top-(window.innerHeight-t.height)/2},750);$("body").removeClass("is-showingNavMenu");return false});function l(e,i){var t=e.left-i.left,n=e.top-i.top,o=e.width/i.width,a=e.height/i.height,r=Math.max(o,a);return"translateX("+t+"px) translateY("+n+"px) scale("+r+")"}$(".Gallery-imgWrapper").on("click",function(e){var t=$(this).find(".Gallery-img"),n=$(".Gallery-img"),o=n.index(t),a=t.clone(),r=t[0].getBoundingClientRect();var s=$('<div class="BodyOverlay"><div class="BodyOverlay-background"></div></div>'),c=$('<a class="BodyOverlay-arrow BodyOverlay-arrow--left" href="#"></a>'),d=$('<a class="BodyOverlay-arrow BodyOverlay-arrow--right" href="#"></a>'),u=$('<a class="BodyOverlay-imgWrapper" href="#"></a>');function g(e){return function(){var i=o+e;if(i<0||i>=n.length){return false}o=i;t=$(n[o]);a.remove();a=t.clone();a.attr("class","BodyOverlay-img").attr("sizes","100vw").addClass("BodyOverlay-img--from"+(e<0?"Left":"Right")).appendTo(u);c.toggle(o>0);d.toggle(o<n.length-1);return false}}c.append($(".js-templateArrowLeft").html()).toggle(o>0).on("click",g(-1));d.append($(".js-templateArrowRight").html()).toggle(o<n.length-1).on("click",g(1));$(window).on("keydown.bodyOverlay",function(e){if(e.keyCode===27){s.trigger("click")}if(e.keyCode===37){g(-1)()}if(e.keyCode===39){g(1)()}});a.attr("class","BodyOverlay-img").attr("sizes","100vw");requestAnimationFrame(function(){u.append(a);s.append(u).append(c).append(d).appendTo("body").on("click",function(){s.removeClass("is-visible");var e=t[0].getBoundingClientRect(),n=a[0].getBoundingClientRect();a.addClass("is-animatable").css("transform",l(e,n)).one("transitionend webkitTransitionEnd",i(function(){clearTimeout(o);s.remove();$(window).off("keydown.bodyOverlay")}));var o=setTimeout(function(){a.trigger("transitionend")},1250);return false});var e=a[0].getBoundingClientRect();a.css("transform",l(r,e)).one("transitionend webkitTransitionEnd",i(function(){clearTimeout(n);a.removeClass("is-animatable")}));var n=setTimeout(function(){a.trigger("transitionend")},1250);requestAnimationFrame(function(){s.addClass("is-visible");a.addClass("is-animatable").css("transform","")})});return false});$(".Section-toggleSubsectionButton").on("click",function(){var e=$(this),i=e.parents(".Section"),t=i.find(".Section-background"),n=i.find(".Section-background, .Section-heading, .Section-toggleSubsectionButton, .Section-subheading"),o=!i.hasClass("is-showingSubsection");if(n.hasClass("is-animatable")){return false}var a=n.map(function(e,i){return i.getBoundingClientRect()}).get();var r=n.map(function(e,i){return getComputedStyle(i).opacity}).get();if(o){t.height(a[0].height)}i.toggleClass("is-showingSubsection");var s=n.map(function(e,i){return i.getBoundingClientRect()}).get();n.each(function(e,i){var t=a[e].top+a[e].height/2,n=s[e].top+s[e].height/2,l=t-n,c="translateY("+l+"px)";if($(i).is(".Section-toggleSubsectionButton")){var d=o?0:45;c+=" rotate("+d+"deg)"}$(i).css({opacity:r[e],transform:c})});setTimeout(function(){if(!o){t.css("height","")}n.addClass("is-animatable").css({opacity:"",transform:""}).one("transitionend webkitTransitionEnd",function(e){if(n.is(e.target)){n.removeClass("is-animatable")}})},1e3/60);return false});$(".Section-backgroundVideo--last").on("timeupdate",function(e){var i=this.currentTime/this.duration,t=$(this).parents(".Section");t.toggleClass("is-showingSubheading",i>=.85);if(i>=.85){$("body").removeClass("is-showingIntro")}});$(".Section-playButton").on("click",function(){var e=$(this).parents(".Section").first(),i=e.find(".Section-backgroundVideo");i[0].play();return false});$(".Section-signupLink").on("click",function(){if(window.adf){adf.ClickTrack(this,456770,"clickApply",{})}});$(".Header-menuToggler").on("click",function(){$("body").toggleClass("is-showingNavMenu");return false});$(".Section-backgroundVideo").on("click",function(){if(!Modernizr.autoplayvideo){if(!this.paused){this.pause()}}}).on("play",function(){var e=$(this).parents(".Section").first();e.addClass("is-playingVideo")}).on("pause",function(){var e=$(this).parents(".Section").first();e.removeClass("is-playingVideo")});$(window).on("load",function(){$("body").addClass("is-loaded")});setTimeout(function(){$("body").addClass("is-loaded")},1e3);$(function(){var e=$(".Section-backgroundVideo:not(.Section-backgroundVideo--last)").last().get(0),i=e.play();if(i){i.then(function(){e.pause();Modernizr.addTest("autoplayvideo",true)}).catch(function(e){Modernizr.addTest("autoplayvideo",!/gesture/.test(e.message))})}else{var t=setTimeout(function(){Modernizr.addTest("autoplayvideo",false)},3e3);$(e).one("timeupdate",function(){clearTimeout(t);Modernizr.addTest("autoplayvideo",true)})}$("video").each(function(e,i){i.disableRemotePlayback=true});s();$(".Section-bodyHeading").fitText(.95);$(".Gallery-masonry").masonry({itemSelector:".Gallery-imgWrapper",percentPosition:true,transitionDuration:0}).find(".Gallery-img").on("load",function(){$(".Gallery-masonry").masonry()});if(!Modernizr.objectfit){$(window).on("resize",function(){$(".Section-backgroundVideo").each(function(e,i){var t=$(i),n=i.getBoundingClientRect(),o=t.parent()[0].getBoundingClientRect(),a=(n.height-o.height)/2;t.css("margin-top",-a+"px")})});$(window).trigger("resize")}})})();